<?xml version="1.0" encoding="utf-8"?>
<Project>
  <!--
    ***********************************************************************************************
    ***********************************************************************************************
                                            MainAppx Section
    ***********************************************************************************************
    ***********************************************************************************************
    -->

  <Target Name="_GenerateExtensionProjectProperties">
    <PropertyGroup>
      <AppxExtensionDirectory>$([System.IO.Path]::Combine($(SolutionRoot), src, extensions))</AppxExtensionDirectory>
    </PropertyGroup>
    <ItemGroup>
      <AppxExtensionProjects Include="$([System.IO.Directory]::GetFiles($(AppxExtensionDirectory), *.csproj, SearchOption.AllDirectories))" />
    </ItemGroup>
  </Target>

  <!--
    Defining the "ProjectReference" item for the main appx project to copy them (output files) in build time.
  -->
  <Target Name="_AppendExtensionProjectReferences" DependsOnTargets="_GenerateExtensionProjectProperties">
    <ItemGroup>
      <ProjectReference Include="@(AppxExtensionProjects)" />
    </ItemGroup>
  </Target>

  
  <!--
    ***********************************************************************************************
    ***********************************************************************************************
                                            AppxExtension Section
    ***********************************************************************************************
    ***********************************************************************************************
    -->


  <!--
    Defining the "Private" property to false when building in visual studio.
    (Don't need to copy the api assembly to the (bin) output directory.)
  -->
  <Target Name="_SetProjectReferenceToPrivate" BeforeTargets="BeforeBuild" Condition="'$(AppxExtension)'=='true'">
    <ItemGroup Condition="'$(BuildingInsideVisualStudio)'=='true'">
      <ProjectReference Private="false" Include="$(GZSkinsXApiProj)"/>
    </ItemGroup>
  </Target>
</Project>
